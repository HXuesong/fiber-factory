$(function () {
    var Title= $("#title");
    var Data = $("#data");

    var title = [
        ['ECC', 'D1处直径', 'DeltaPlus检验值', '最大跳动值'],
        ['1310MFD', 'DeltaPlus检验值', 'DeltaTo检验值', '光纤总长度'],
        ['λc', 'Top_A', '最大跳动值', '重量误差'],
        ['Zero DML.', 'OD_Core检验值', '包层直径上', '重量误差']
    ];

    var data=[
        [
            ['1.40e-01', '1.48e-01', '1.55e-01', '1.15e-01', '1.06e-01', '1.43e-01', '1.81e-01', '1.18e-01', '1.84e-01', '1.70e-01', '2.14e-01', '2.35e-01', '2.26e-01', '2.46e-01', '3.33e-01', '1.56e-01', '2.46e-01', '2.23e-01', '2.54e-01', '2.35e-01', '1.52e-01', '3.53e-01', '3.23e-01', '4.21e-01', '3.51e-01', '2.75e-01', '2.83e-01', '2.55e-01', '2.33e-01', '2.62e-01', '1.58e-01', '2.33e-01', '3.78e-01', '3.04e-01', '2.35e-01', '2.32e-01', '6.30e-02', '1.71e-01', '2.69e-01', '2.00e-01', '2.12e-01', '2.46e-01'],
            ['72.6±2.17e+00', '72.6±2.17e+00', '72.6±2.17e+00', '75.8±1.03e+00', '72.4±1.97e+00', '72.4±1.97e+00', '72.4±1.97e+00', '72.4±1.97e+00', '75.0±6.50e-01', '75.0±6.50e-01', '75.0±6.50e-01', '76.2±5.80e-01', '76.2±5.80e-01', '71.8±1.41e+00', '71.8±1.41e+00', '71.8±1.41e+00', '71.8±1.41e+00', '71.6±1.22e+00', '71.6±1.22e+00', '73.1±1.90e-01', '73.1±1.90e-01', '73.3±5.50e-02', '73.3±5.50e-02', '73.3±5.50e-02', '73.3±5.50e-02', '73.4±7.50e-02', '73.4±7.50e-02', '73.4±7.50e-02', '73.4±7.50e-02', '75.2±1.66e+00', '73.8±3.35e-01', '75.5±1.32e+00', '75.2±1.66e+00', '75.2±1.66e+00', '73.5±2.25e-02', '73.5±2.25e-02', '73.6±1.00e-02', '73.6±1.00e-02', '74.0±4.10e-01', '74.0±4.10e-01', '75.2±8.55e-01', '76.5±3.60e-01'],
            ['0.3±2.65e-02', '0.3±1.85e-02', '0.3±8.00e-03', '0.3±2.65e-02', '0.3±6.00e-03', '0.3±5.50e-03', '0.4±2.00e-03', '0.4±3.35e-02', '0.3±1.20e-02', '0.4±3.00e-03', '0.4±3.20e-02', '0.3±1.70e-02', '0.4±3.00e-02', '0.3±2.95e-02', '0.3±5.00e-03', '0.4±3.90e-02', '0.4±3.90e-02', '0.3±7.35e-02', '0.3±7.35e-02', '0.3±7.35e-02', '0.3±7.35e-02', '0.3±6.00e-03', '0.3±1.95e-02', '0.3±5.00e-04', '0.4±4.75e-02', '0.3±1.85e-02', '0.3±1.80e-02', '0.4±3.70e-02', '0.4±3.70e-02', '0.3±1.10e-02', '0.3±1.00e-02', '0.3±1.00e-02', '0.3±2.10e-02', '0.3±2.10e-02', '0.3±1.15e-02', '0.4±4.10e-02', '0.3±1.60e-02', '0.4±3.65e-02', '0.3±1.95e-02', '0.4±3.30e-02', '0.4±5.25e-02', '0.4±5.25e-02'],
            ['0.4±8.85e-02', '0.5±2.20e-02', '0.5±2.20e-02', '0.4±1.10e-01', '0.4±1.10e-01', '0.4±1.10e-01', '0.4±1.10e-01', '0.4±1.10e-01', '0.4±1.10e-01', '0.4±1.10e-01', '0.4±1.10e-01', '0.4±1.10e-01', '0.4±1.10e-01', '0.7±1.25e-01', '0.7±1.25e-01', '0.6±9.50e-03', '0.7±1.16e-01', '1.0±1.82e-01', '1.5±3.67e-01', '0.9±7.70e-02', '1.4±4.73e-01', '1.2±6.74e-01', '1.2±6.74e-01', '1.2±6.74e-01', '1.2±6.74e-01', '1.2±6.74e-01', '1.2±6.74e-01', '0.8±2.54e-01', '1.5±4.21e-01', '0.7±1.02e-01', '0.7±1.02e-01', '0.7±1.02e-01', '0.8±2.25e-02', '1.4±5.49e-01', '1.2±6.74e-01', '1.2±6.74e-01', '1.2±6.74e-01', '1.2±6.74e-01', '1.2±6.74e-01', '1.2±6.74e-01', '1.2±6.74e-01', '1.2±6.74e-01']
        ], [
            ['9.48e+00', '9.39e+00', '9.42e+00', '9.56e+00', '9.39e+00', '9.27e+00', '9.33e+00', '9.49e+00', '9.34e+00', '9.26e+00', '9.19e+00', '9.05e+00', '9.21e+00', '9.25e+00', '9.33e+00', '9.39e+00', '9.07e+00', '9.30e+00', '9.19e+00', '9.02e+00', '9.09e+00', '9.25e+00', '9.11e+00', '9.08e+00', '9.29e+00', '9.25e+00', '9.33e+00', '9.08e+00', '9.17e+00', '9.09e+00', '8.99e+00', '9.00e+00', '8.85e+00', '8.96e+00', '9.06e+00', '8.95e+00', '9.02e+00', '8.82e+00', '8.86e+00', '9.00e+00', '8.91e+00', '9.07e+00', '9.03e+00', '8.88e+00', '8.97e+00', '8.82e+00', '8.81e+00'],
            ['0.3±1.50e-02', '0.3±2.00e-03', '0.3±1.30e-02', '0.3±1.50e-02', '0.4±5.85e-02', '0.4±5.85e-02', '0.3±1.30e-02', '0.4±4.55e-02', '0.4±5.85e-02', '0.4±5.85e-02', '0.4±5.85e-02', '0.4±5.85e-02', '0.3±7.35e-02', '0.3±7.35e-02', '0.3±7.35e-02', '0.3±7.35e-02', '0.3±7.35e-02', '0.3±7.35e-02', '0.3±7.35e-02', '0.3±2.50e-02', '0.3±2.50e-03', '0.4±4.60e-02', '0.4±4.60e-02', '0.3±7.35e-02', '0.3±7.35e-02', '0.3±7.35e-02', '0.3±7.35e-02', '0.3±7.35e-02', '0.3±7.35e-02', '0.3±3.30e-02', '0.4±4.05e-02', '0.3±3.30e-02', '0.3±5.00e-04', '0.4±4.00e-02', '0.4±4.00e-02', '0.3±3.65e-02', '0.3±1.00e-03', '0.3±3.75e-02', '0.3±3.75e-02', '0.4±4.00e-03', '0.4±4.00e-03', '0.4±3.20e-02', '0.4±3.20e-02', '0.3±7.35e-02', '0.3±7.35e-02', '0.3±7.35e-02', '0.3±7.35e-02'],
            ['0.3±1.35e-02', '0.3±4.00e-03', '0.3±4.00e-03', '0.4±3.50e-03', '0.3±4.00e-03', '0.3±1.55e-02', '0.3±1.95e-02', '0.3±1.95e-02', '0.4±1.50e-03', '0.4±1.50e-03', '0.4±1.50e-03', '0.4±1.50e-03', '0.3±8.00e-03', '0.3±2.50e-03', '0.3±2.00e-03', '0.3±1.00e-03', '0.3±5.00e-04', '0.3±1.00e-03', '0.4±4.00e-03', '0.4±2.00e-03', '0.4±2.00e-03', '0.4±1.00e-03', '0.4±1.00e-03', '0.4±6.00e-03', '0.4±2.50e-03', '0.4±2.00e-03', '0.4±1.50e-03', '0.4±1.00e-03', '0.4±1.50e-03', '0.4±2.50e-03', '0.4±2.50e-03', '0.4±3.50e-03', '0.4±3.50e-03', '0.4±3.50e-03', '0.4±3.50e-03', '0.4±3.00e-03', '0.4±3.00e-03', '0.4±5.00e-04', '0.4±8.00e-03', '0.4±1.15e-02', '0.4±1.15e-02', '0.4±1.15e-02', '0.4±1.15e-02', '0.4±3.50e-03', '0.4±5.00e-04', '0.4±1.00e-03', '0.4±6.50e-03'],
            ['1224.9±1.74e+02', '1224.9±1.74e+02', '1224.9±1.74e+02', '1224.9±1.74e+02', '1203.0±1.52e+02', '1203.0±1.52e+02', '1376.5±2.19e+01', '1376.5±2.19e+01', '1077.4±2.60e+01', '1134.2±3.08e+01', '1266.0±1.01e+02', '1382.7±1.57e+01', '1481.6±8.32e+01', '1481.6±8.32e+01', '1481.6±8.32e+01', '1481.6±8.32e+01', '1481.6±8.32e+01', '1481.6±8.32e+01', '1481.6±8.32e+01', '1481.6±8.32e+01', '1481.6±8.32e+01', '1481.6±8.32e+01', '1481.6±8.32e+01', '1060.7±9.27e+00', '1088.9±1.90e+01', '1088.9±1.90e+01', '1088.9±1.90e+01', '1284.0±1.76e+02', '1284.0±1.76e+02', '1512.5±5.24e+01', '1512.5±5.24e+01', '1336.4±2.28e+02', '1336.4±2.28e+02', '1115.2±7.29e+00', '1343.7±2.21e+02', '1279.1±2.28e+02', '1279.1±2.28e+02', '1279.1±2.28e+02', '1279.1±2.28e+02', '1262.9±2.12e+02', '1490.7±1.62e+01', '1211.7±1.60e+02', '1439.4±6.75e+01', '1535.9±2.90e+01', '1535.9±2.90e+01', '1535.9±2.90e+01', '1535.9±2.90e+01']
        ], [
            ['1.13e+03', '1.29e+03', '1.27e+03', '1.27e+03', '1.24e+03', '1.20e+03', '1.24e+03', '1.23e+03', '1.15e+03', '1.21e+03', '1.24e+03', '1.27e+03', '1.27e+03', '1.22e+03', '1.25e+03', '1.20e+03', '1.19e+03', '1.19e+03', '1.21e+03'],
            ['59.0±4.90e+01', '59.0±4.90e+01', '59.0±4.90e+01', '59.0±4.90e+01', '22.8±1.28e+01', '22.8±1.28e+01', '22.8±1.28e+01', '22.8±1.28e+01', '39.0±3.50e+00', '36.0±5.00e-01', '39.5±3.00e+00', '45.0±2.50e+00', '50.0±2.50e+00', '47.5±5.00e+00', '47.5±5.00e+00', '80.2±2.78e+01', '80.2±2.78e+01', '80.2±2.78e+01', '80.2±2.78e+01'],
            ['1.1±7.85e-01', '1.1±7.85e-01', '1.1±7.85e-01', '1.1±7.85e-01', '0.4±1.17e-01', '0.6±1.85e-02', '0.7±9.45e-02', '1.3±5.54e-01', '1.1±7.85e-01', '1.1±7.85e-01', '1.1±7.85e-01', '0.5±1.99e-01', '0.5±1.99e-01', '0.9±2.11e-01', '1.5±3.74e-01', '0.5±1.82e-01', '0.8±8.25e-02', '0.9±8.10e-02', '1.5±4.39e-01'],
            ['-1680.8±6.42e+01', '-1489.2±1.27e+02', '-1278.8±8.32e+01', '-1165.8±2.98e+01', '700.0±1.84e+03', '700.0±1.84e+03', '700.0±1.84e+03', '700.0±1.84e+03', '-983.2±1.53e+02', '852.8±1.68e+03', '852.8±1.68e+03', '700.0±1.84e+03', '700.0±1.84e+03', '700.0±1.84e+03', '700.0±1.84e+03', '700.0±1.84e+03', '700.0±1.84e+03', '700.0±1.84e+03', '700.0±1.84e+03']
        ], [
            ['1.30e+03', '1.31e+03', '1.31e+03', '1.31e+03', '1.31e+03', '1.31e+03', '1.31e+03', '1.31e+03', '1.30e+03', '1.30e+03', '1.31e+03', '1.30e+03', '1.30e+03', '1.30e+03', '1.30e+03', '1.31e+03', '1.31e+03', '1.31e+03', '1.31e+03', '1.31e+03', '1.31e+03', '1.31e+03', '1.31e+03', '1.31e+03', '1.31e+03', '1.31e+03', '1.31e+03', '1.31e+03', '1.31e+03', '1.31e+03', '1.31e+03', '1.31e+03', '1.31e+03', '1.31e+03', '1.31e+03', '1.32e+03', '1.32e+03', '1.31e+03', '1.31e+03', '1.32e+03', '1.31e+03', '1.31e+03', '1.31e+03', '1.32e+03', '1.32e+03', '1.31e+03'],
            ['8.1±2.43e-01', '8.1±2.43e-01', '8.1±2.43e-01', '8.1±2.43e-01', '8.1±2.43e-01', '8.0±6.75e-02', '8.2±1.75e-01', '8.4±1.50e-02', '8.4±1.50e-02', '8.4±2.25e-02', '8.5±2.75e-02', '8.6±1.17e-01', '8.4±1.75e-02', '8.4±2.25e-02', '8.6±1.43e-01', '8.0±1.38e-01', '8.2±1.75e-02', '8.0±1.08e-01', '8.2±4.75e-02', '8.3±7.75e-02', '8.5±1.92e-01', '8.3±1.00e-01', '8.6±1.70e-01', '8.2±2.68e-01', '8.2±2.68e-01', '8.2±2.68e-01', '8.2±2.68e-01', '8.5±4.75e-02', '8.6±1.10e-01', '8.5±7.50e-02', '8.7±8.25e-02', '8.0±1.22e-01', '8.4±3.03e-01', '8.3±4.25e-01', '8.3±4.25e-01', '8.1±1.67e-01', '8.5±2.58e-01', '8.3±4.25e-01', '8.3±4.25e-01', '8.2±2.75e-01', '8.2±2.75e-01', '8.1±2.33e-01', '8.4±4.25e-02', '8.4±1.00e-02', '8.5±3.00e-02', '8.6±1.10e-01'],
            ['170.7±3.50e+00', '170.5±3.32e+00', '170.5±3.32e+00', '168.8±1.62e+00', '172.1±1.70e+00', '174.0±1.75e-01', '174.0±1.75e-01', '170.7±3.50e+00', '170.7±3.50e+00', '170.7±3.50e+00', '170.7±3.50e+00', '170.7±3.50e+00', '170.7±3.50e+00', '170.7±3.50e+00', '170.7±3.50e+00', '177.2±2.98e+00', '177.2±2.98e+00', '182.8±2.67e+00', '182.8±2.67e+00', '177.1±2.93e+00', '177.1±2.93e+00', '182.8±2.72e+00', '182.8±2.72e+00', '178.7±4.50e+00', '178.7±4.50e+00', '184.3±1.15e+00', '184.3±1.15e+00', '179.8±5.65e+00', '179.8±5.65e+00', '179.8±5.65e+00', '179.8±5.65e+00', '177.7±3.53e+00', '177.7±3.53e+00', '177.7±3.53e+00', '177.7±3.53e+00', '183.4±2.12e+00', '183.4±2.12e+00', '182.1±8.25e-01', '184.2±1.30e+00', '178.5±4.28e+00', '178.5±4.28e+00', '184.1±1.38e+00', '184.1±1.38e+00', '179.8±5.65e+00', '179.8±5.65e+00', '179.8±5.65e+00'],
            ['-1563.8±1.81e+02', '-1195.0±1.88e+02', '-925.8±8.18e+01', '846.0±1.69e+03', '846.0±1.69e+03', '576.8±1.96e+03', '576.8±1.96e+03', '-1076.2±6.69e+02', '-367.8±3.98e+01', '-1036.5±7.08e+02', '-1036.5±7.08e+02', '-1036.5±7.08e+02', '1104.0±1.43e+03', '1104.0±1.43e+03', '1104.0±1.43e+03', '-1301.0±4.44e+02', '-1301.0±4.44e+02', '-1301.0±4.44e+02', '-1301.0±4.44e+02', '-1301.0±4.44e+02', '-1301.0±4.44e+02', '-1301.0±4.44e+02', '-1301.0±4.44e+02', '-688.0±1.69e+02', '32.2±5.51e+02', '-408.0±4.49e+02', '312.2±2.71e+02', '-571.0±2.86e+02', '-571.0±2.86e+02', '149.2±4.34e+02', '149.2±4.34e+02', '668.0±8.45e+01', '668.0±8.45e+01', '786.0±3.35e+01', '961.8±1.42e+02', '674.2±9.08e+01', '674.2±9.08e+01', '934.5±1.70e+02', '934.5±1.70e+02', '1225.0±1.21e+02', '1941.0±5.95e+02', '1820.0±7.16e+02', '1820.0±7.16e+02', '1820.0±7.16e+02', '1820.0±7.16e+02', '1820.0±7.16e+02']
        ]
    ]

    var count=0;

    var currentTitle=title[0];
    var currentData=data[0];

    for(var i=0;i<4;i++){
        Title.find("tr").eq(0).find("td").eq(i).html(currentTitle[i]);
    }

    Data.find("tr").each(function (i) {
            $(this).children('td:eq(0)').html(currentData[0][i]);
            // $(this).children('td:eq(0)').css({color:"yellow"});
            $(this).children('td:eq(1)').html(currentData[1][i]);
            $(this).children('td:eq(2)').html(currentData[2][i]);
            $(this).children('td:eq(3)').html(currentData[3][i]);
    });


    window.FreshInterval=setInterval(function () {
        count++;
        var currentTitle=title[count%4];
        var currentData=data[count%4];

        for(var i=0;i<4;i++){
            Title.find("tr").eq(0).find("td").eq(i).html(currentTitle[i]);
        }

        Data.find("tr").each(function (i) {
                $(this).children('td:eq(0)').html(currentData[0][i]);
                // $(this).children('td:eq(0)').css({color:"yellow"});
                $(this).children('td:eq(1)').html(currentData[1][i]);
                $(this).children('td:eq(2)').html(currentData[2][i]);
                $(this).children('td:eq(3)').html(currentData[3][i]);
        });

    },5000)

    var speed = 100;
    var demo=document.getElementById("demo");
    var demo1=document.getElementById("demo1");
    var demo2=document.getElementById("demo2");
    demo2.innerHTML = demo1.innerHTML;
    function Marquee() {
        if (demo2.offsetTop - demo.scrollTop <= 0) {
            demo.scrollTop -= demo1.offsetHeight;
        } else {
            demo.scrollTop++;
        }
    }
    window.Scrollinterval=setInterval(Marquee, speed);

    $("#speedSelect").change(function(){
        var counter = $('#speedSelect').val();

        clearInterval(Scrollinterval);
        clearInterval(FreshInterval);

        var speed = (counter==5000)?200:50;
        var freshCount=(counter==5000)?counter:counter*10;
        var demo=document.getElementById("demo");
        var demo1=document.getElementById("demo1");
        var demo2=document.getElementById("demo2");
        demo2.innerHTML = demo1.innerHTML;

        var ScrollFunction = function(){
            if (demo2.offsetTop - demo.scrollTop <= 0) {
                demo.scrollTop -= demo1.offsetHeight;
            } else {
                demo.scrollTop++;
            }
        }
        var FreshFunction = function(){
            count++;
            var currentTitle=title[count%4];
            var currentData=data[count%4];

            for(var i=0;i<4;i++){
                Title.find("tr").eq(0).find("td").eq(i).html(currentTitle[i]);
            }

            Data.find("tr").each(function (i) {
                $(this).children('td:eq(0)').html(currentData[0][i]);
                $(this).children('td:eq(0)').css({color:"yellow"});
                $(this).children('td:eq(1)').html(currentData[1][i]);
                $(this).children('td:eq(2)').html(currentData[2][i]);
                $(this).children('td:eq(3)').html(currentData[3][i]);
            });
        }

        window.Scrollinterval = setInterval(ScrollFunction, speed);
        window.FreshInterval = setInterval(FreshFunction, freshCount);
    });
});