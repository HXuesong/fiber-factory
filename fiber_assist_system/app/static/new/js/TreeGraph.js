// var zNodes=[
//     {"id": "1", "pId": "", "name": "重量 <= 49503.0", "isempty": "false", "label": "","isleaf":"false", 'mean': 9.090500, 'mse': 0.014250},
//     {"id": "2", "pId": "1", "name": "有效长度 <= 1685.0", "isempty": "false", "label": "","isleaf":"false", 'mean': 9.1328, 'mse': 0.013672},
//     {"id": "3", "pId": "2", "name": "9.215", "isempty": "false", "label": "","isleaf":"true", 'mean': 9.215, 'mse': 0.015},
//     {"id": "4", "pId": "2", "name": "重量 <= 47282.5", "isempty": "false", "label": "","isleaf":"false", 'mean': 9.1094, 'mse': 0.013199},
//     {"id": "5", "pId": "4", "name": "9.174", "isempty": "false", "label": "","isleaf":"true", 'mean': 9.174, 'mse': 0.01},
//     {"id": "6", "pId": "4", "name": "密度 <= 0.37", "isempty": "false", "label": "","isleaf":"false", 'mean': 9.0938, 'mse': 0.014},
//     {"id": "7", "pId": "6", "name": "9.154", "isempty": "false", "label": "","isleaf":"true", 'mean': 9.154, 'mse': 0.022},
//     {"id": "8", "pId": "6", "name": "密度 <= 0.379", "isempty": "false", "label": "","isleaf":"false", 'mean': 9.0703, 'mse': 0.0093307},
//     {"id": "9", "pId": "8", "name": "9.015", "isempty": "false", "label": "","isleaf":"true", 'mean': 9.015, 'mse': 0.004},
//     {"id": "10", "pId": "8", "name": "9.117", "isempty": "false", "label": "","isleaf":"true", 'mean': 9.117, 'mse': 0.013},
//     {"id": "11", "pId": "1", "name": "重量 <= 51213.0", "isempty": "false", "label": "","isleaf":"false", 'mean': 9.0156, 'mse': 0.017746},
//     {"id": "12", "pId": "11", "name": "重量 <= 49935.0", "isempty": "false", "label": "","isleaf":"false", 'mean': 8.9922, 'mse': 0.0076714},
//     {"id": "13", "pId": "12", "name": "9.051", "isempty": "false", "label": "","isleaf":"true", 'mean': 9.051, 'mse': 0.004},
//     {"id": "14", "pId": "12", "name": "8.935", "isempty": "false", "label": "","isleaf":"true", 'mean': 8.935, 'mse': 0.009},
//     {"id": "15", "pId": "11", "name": "9.063", "isempty": "false", "label": "","isleaf":"true", 'mean': 9.063, 'mse': 0.037}
// ];

// var zNodes=[
//     {"id": "1", "pId": "0", "name": "OD_Core检验值 <= 8.305", "isempty": "false", "label": "", "isleaf": "false", "mean": "0.29834", "mse": "0.01387"},{"id": "2", "pId": "1", "name": "DeltaMinus检验值 <= 0.032", "isempty": "false", "label": "", "isleaf": "false", "mean": "0.25537", "mse": "0.0083771"},{"id": "3", "pId": "2", "name": "有效长度 <= 1679.5", "isempty": "false", "label": "", "isleaf": "false", "mean": "0.19177", "mse": "0.0090027"},{"id": "4", "pId": "3", "name": "DeltaMinus检验值 <= 0.025", "isempty": "false", "label": "", "isleaf": "false", "mean": "0.13269", "mse": "0.0023346"},{"id": "5", "pId": "4", "name": "0.129", "isempty": "false", "label": "", "isleaf": "true", "mean": "0.129", "mse": "0.003"},{"id": "6", "pId": "4", "name": "0.136", "isempty": "false", "label": "", "isleaf": "true", "mean": "0.136", "mse": "0.002"},{"id": "7", "pId": "3", "name": "有效长度 <= 1723.5", "isempty": "false", "label": "", "isleaf": "false", "mean": "0.23279", "mse": "0.013336"},{"id": "8", "pId": "7", "name": "0.251", "isempty": "false", "label": "", "isleaf": "true", "mean": "0.251", "mse": "0.014"},{"id": "9", "pId": "7", "name": "0.219", "isempty": "false", "label": "", "isleaf": "true", "mean": "0.219", "mse": "0.013"},{"id": "10", "pId": "2", "name": "DeltaMinus检验值 <= 0.063", "isempty": "false", "label": "", "isleaf": "false", "mean": "0.35791", "mse": "0.0077515"},{"id": "11", "pId": "10", "name": "跳动合格 <= 0.5", "isempty": "false", "label": "", "isleaf": "false", "mean": "0.32349", "mse": "0.0060005"},{"id": "12", "pId": "11", "name": "0.36", "isempty": "false", "label": "", "isleaf": "true", "mean": "0.36", "mse": "0.006"},{"id": "13", "pId": "11", "name": "0.279", "isempty": "false", "label": "", "isleaf": "true", "mean": "0.279", "mse": "0.005"},{"id": "14", "pId": "10", "name": "0.435", "isempty": "false", "label": "", "isleaf": "true", "mean": "0.435", "mse": "0.01"},{"id": "15", "pId": "1", "name": "DeltaMinus检验值 <= 0.018", "isempty": "false", "label": "", "isleaf": "false", "mean": "0.33765", "mse": "0.020126"},{"id": "16", "pId": "15", "name": "OD_Core检验值 <= 8.54", "isempty": "false", "label": "", "isleaf": "false", "mean": "0.38379", "mse": "0.030746"},{"id": "17", "pId": "16", "name": "OD_Core检验值 <= 8.335", "isempty": "false", "label": "", "isleaf": "false", "mean": "0.34644", "mse": "0.031342"},{"id": "18", "pId": "17", "name": "0.417", "isempty": "false", "label": "", "isleaf": "true", "mean": "0.417", "mse": "0.034"},{"id": "19", "pId": "17", "name": "0.29", "isempty": "false", "label": "", "isleaf": "true", "mean": "0.29", "mse": "0.027"},{"id": "20", "pId": "16", "name": "0.468", "isempty": "false", "label": "", "isleaf": "true", "mean": "0.468", "mse": "0.027"},{"id": "21", "pId": "15", "name": "OD_Core检验值 <= 8.325", "isempty": "false", "label": "", "isleaf": "false", "mean": "0.30127", "mse": "0.013596"},{"id": "22", "pId": "21", "name": "有效长度 <= 1727.5", "isempty": "false", "label": "", "isleaf": "false", "mean": "0.3252", "mse": "0.02034"},{"id": "23", "pId": "22", "name": "0.2", "isempty": "false", "label": "", "isleaf": "true", "mean": "0.2", "mse": "0.005"},{"id": "24", "pId": "22", "name": "0.421", "isempty": "false", "label": "", "isleaf": "true", "mean": "0.421", "mse": "0.026"},{"id": "25", "pId": "21", "name": "DeltaMinus检验值 <= 0.065", "isempty": "false", "label": "", "isleaf": "false", "mean": "0.29004", "mse": "0.01133"},{"id": "26", "pId": "25", "name": "0.242", "isempty": "false", "label": "", "isleaf": "true", "mean": "0.242", "mse": "0.014"},{"id": "27", "pId": "25", "name": "0.381", "isempty": "false", "label": "", "isleaf": "true", "mean": "0.381", "mse": "0.005"}
//     ];
//
var path=tree_path
var rule=tree_rule

var count=0;//是否有动画的计数器
window.msgSpan = document.createElement("span");//路径提示
var canvas;

$(function(){
    window.ruleSpan = document.createElement("span");
    document.getElementById("treediv").appendChild(ruleSpan);
})


function calcStringPixelsCount(str, strFontSize) {
    // 字符串字符个数
    var stringCharsCount = str.length;

    // 字符串像素个数
    var stringPixelsCount = 0;

    // JS 创建HTML元素：span
    var elementPixelsLengthRuler = document.createElement("span");
    elementPixelsLengthRuler.style.fontSize = strFontSize;  // 设置span的fontsize
    elementPixelsLengthRuler.style.visibility = "hidden";  // 设置span不可见
    elementPixelsLengthRuler.style.display = "inline-block";
    elementPixelsLengthRuler.style.wordBreak = "break-all !important";  // 打断单词

    // 添加span
    document.body.appendChild(elementPixelsLengthRuler);

    for (var i =0; i < stringCharsCount; i++) {
        // 判断字符是否为空格，如果是用&nbsp;替代，原因如下：
        // 1）span计算单个空格字符（ ），其像素长度为0
        // 2）空格字符在字符串的开头或者结果，计算时会忽略字符串
        if (str[i] == " ") {
            elementPixelsLengthRuler.innerHTML = "&nbsp;";
        } else {
            elementPixelsLengthRuler.innerHTML = str[i];
        }

        stringPixelsCount += elementPixelsLengthRuler.offsetWidth;
    }

    return stringPixelsCount;
}

function treeMenu(a){
    //列表map形式
    this.tree=a||[];
    this.groups={};
    //存放id与对应的name映射
    this.nameMap={}
    //得到每个点对应的层次,为了后期进行布局
    this.levelMap={}
};
treeMenu.prototype={
    init:function(pid){
        this.group();
        this.MapNamebyId();
        this.setIdLevel(pid);
        return this.rescusive(pid);
    },
    group:function(){
        for(var i=0;i<this.tree.length;i++){
            //存在该grops则直接添加
            if(this.groups[this.tree[i].pId]){
                this.groups[this.tree[i].pId].push(this.tree[i]);
            }else{
                this.groups[this.tree[i].pId]=[];
                this.groups[this.tree[i].pId].push(this.tree[i]);
            }
        }
    },
    setIdLevel:function(pid){
        var level=1;
        this.levelMap[pid]=level;
        var gs=this.groups[pid];
        var temp=[]
        while(gs){
            level++;
            if(gs==null||gs==undefined||gs.length==0)
                break;
            temp=[]
            for(var i=0;i<gs.length;i++){
                var myid=gs[i]["id"];
                this.levelMap[myid]=level;
                subgs=this.groups[myid];
                if(subgs instanceof Array &&subgs!=null){
                    for(var j=0;j<subgs.length;j++){
                        temp.push(subgs[j]);
                    }
                }
            }
            gs=temp;
        }
    },
    MapNamebyId:function(){
        for(var i=0;i<this.tree.length;i++){
            map=this.tree[i]
            this.nameMap[map["id"]]=map["name"]
        }
    },
    rescusive:function (number){
        var data=[]
        var node={}
        var styleValue={}
        //某个节点下的子节点
        var a=this.groups[number];
        var nodeName=this.nameMap[number];
        if(a==null||a==undefined){
            return node;
        }
        for(var i=0;i<a.length;i++){
            children=this.rescusive(a[i].id);
            data.push(children);
        }
        return node;
    },
    //创建组织结构图
    createTreeVisual:function(mytree){
        canvas = document.getElementById("canvastree");
        var context = canvas.getContext("2d");
        canvas.width=$('#treediv').width();
        canvas.height=$('#treediv').height();

        context.clearRect(0,0,canvas.width,canvas.height);
        nodeArray=[];
        // clearInterval(interval);
        // clearTimeout(nodeTimeout);
        // clearTimeout(spanTimeout);

        // for(var i=0;i<spanArray.length;i++)
        //     spanArray[i].remove();


        // alert($('#treediv').width());
        // alert(canvas.width);
        // alert($('#treediv').height());
        // alert(canvas.height);
        var node=new Nodes(context,zNodes[0].id,zNodes[0].pId,this.levelMap[1],this.groups[1],zNodes[0].name,zNodes[0].mse,zNodes[0].mean,zNodes[0].isleaf,mytree,canvas.width/2);

        if(count<=0)
            create(node);
        else
            createWithoutCartoon(node);


        function create(node){
            if(node!=null){
                nodeTimeout=setTimeout(function () {
                    node.drawCircle(node);
                    if(node.leftchild!=null){
                        node.drawLine(context,node,node.leftchild,colors[node.level],width[node.level-1],distance[node.level-1],0,radiuses[node.level-1]);
                        node.drawLine(context,node,node.rightchild,colors[node.level],width[node.level-1],distance[node.level-1],1,radiuses[node.level-1]);
                    }
                    node.createSpan(node);
                },(node.level-1)*timeInterval)

                nodeArray.push(node);

                create(node.leftchild);
                create(node.rightchild);
            }
            count++;
        }

        function createWithoutCartoon(node){
            if(node!=null){
                node.drawCircle(node);
                if(node.leftchild!=null){
                    drawLineWithoutCartoon(context,node,node.leftchild,colors[node.level],width[node.level-1],distance[node.level-1],0,radiuses[node.level-1]);
                    drawLineWithoutCartoon(context,node,node.rightchild,colors[node.level],width[node.level-1],distance[node.level-1],1,radiuses[node.level-1]);
                }
                nodeArray.push(node);
                createWithoutCartoon(node.leftchild);
                createWithoutCartoon(node.rightchild);
            }
        }
        createDeclare();

        setTimeout(function () {
            for(var i=0;i<spanArray.length;i++)
                spanArray[i].style.display='block';
        createRule();
        },4.5*timeInterval)
    }
}


var  nodeArray=[];//存放node的数组
var  spanArray=[];//存放span的数组
var  interval;
var  nodeTimeout;
var  spanTimeout;
const markColor="#96e5f1";//高亮颜色
const colors=["#daf7f2","#3bcbd5","#3997cc","#0379ce","#005aaf","#0252a2"];//节点颜色

const radiuses=[40,30,25,20,15,10]//节点半径
const postY=[450,330,230,150,90,40]//节点y坐标
const intervals=[0.25,0.12,0.06,0.03,0.015]//节点与父节点x坐标间隔
const totalInterval=$('#treediv').width()*0.475
const width=[10,7.5,5,2.5,1]//树枝宽度
const distance=[25,15,2.5,2.5,2.5]//树枝离子节点y距离
const fontSize=[16,14,12,10,10,10]//字体大小

const timeInterval=1000;//间隔时间

class Nodes{
    constructor(context,id,pid,level,childrens,name,mse,mean,isleaf,mytree,x){
        this.context=context
        this.id=id
        this.pid=pid
        this.level=level
        this.name=name
        this.mean=mean
        this.mse=mse
        this.label=""
        this.isleaf=isleaf
        this.x=x
        this.y=postY[this.level-1]
        this.color=colors[this.level-1]
        this.radius=radiuses[this.level-1]


        if(childrens!=undefined){
            this.leftchild=new Nodes(context,childrens[0].id,childrens[0].pId,this.level+1,mytree.groups[childrens[0].id],childrens[0].name,childrens[0].mse,childrens[0].mean,childrens[0].isleaf,mytree,this.x-$('#canvastree').width()*intervals[this.level-1]);
            this.rightchild=new Nodes(context,childrens[1].id,childrens[1].pId,this.level+1,mytree.groups[childrens[1].id],childrens[1].name,childrens[1].mse,childrens[1].mean,childrens[1].isleaf,mytree,this.x+$('#canvastree').width()*intervals[this.level-1]);
        }else{
            this.leftchild=null;
            this.rightchild=null;
        }

        this.isempty=false;//是否被画出
        this.isShrinked=false;//是否收缩
    }

    drawCircle(node){
        node.context.beginPath();
        node.context.arc(node.x,node.y,node.radius,0,2*Math.PI);
        node.context.fillStyle=node.color;
        node.context.fill();
        node.context.closePath();
    }

    drawLine(context,c1,c2,color,Width,radius1,index,radius2) {
        var x=c1.x+radius2*Math.pow(-1,index+1);
        var y=c1.y;
        var deltaX=c2.x-c1.x;
        var deltaY=c2.y-c1.y;
        var tempx=0;
        var tempy=0;
        function colDownLine(){
            if(tempx<=Math.abs(deltaX)-radius2){
                context.beginPath();
                context.moveTo(x,c1.y);
                context.lineTo(x+=deltaX/(timeInterval/5),y);
                tempx+=Math.abs(deltaX/(timeInterval/5));
                context.lineWidth = Width;
                context.strokeStyle=color;
                context.stroke();
                context.closePath();
            }else if(tempy<=Math.abs(deltaY)-radius1){
                context.beginPath();
                context.moveTo(c2.x,c1.y+Width/2);
                context.lineTo(x,y+=deltaY/(timeInterval/8));
                tempy+=Math.abs(deltaY/(timeInterval/8));
                context.lineWidth = Width;
                context.strokeStyle=color;
                context.stroke();
                context.closePath();
            }
        }
        interval=setInterval(colDownLine,timeInterval/500);
    }

    createSpan(node){
        var spanON = document.createElement("span");
        spanON.style.position="absolute";
        spanON.style.top=node.y+$('#analysismat').height()*0.19-200+'px';
        // spanON.style.top=node.y+'px';
        // spanON.style.left=node.x+node.radius-(6-node.level)*12+'px';

        // spanON.style.backgroundColor="#ffffff";
        spanON.style.color="#fdfbfe";
        // spanON.style.opacity=0.7;
        // spanON.style.fontSize = 16 + "px";
        // spanON.style.fontWeight = "bold";
        spanON.style.fontSize=fontSize[node.level-1]+'px';
        if(node.isleaf=="false"){
            spanON.innerHTML = node.name;
        }
        else{
            spanON.innerHTML = "均值"+node.mean+"<br>"+"方差"+node.mse;
        }

        document.getElementById("treediv").appendChild(spanON);
        node.label=spanON;

        spanArray.push(spanON);

        spanON.style.left=node.x-spanON.offsetWidth/2+'px';
        spanON.style.display='none';

        spanON.addEventListener("mousemove",move);
        spanON.addEventListener("mouseout",out);
        if(node.isleaf=="false")
            spanON.addEventListener("click",click);

        function move() {
            var temp=node;
            var pathArray=[];
            var message="";
            if(temp.isempty==false){
                while(temp!=null){
                    temp.color=markColor;
                    temp.drawCircle(temp);
                    if(temp.isleaf=="false"&&temp!=node){
                        pathArray.push(temp.name);
                    }else{
                        pathArray.push("均值"+node.mean+"/"+"方差"+node.mse);
                    }
                    if(temp.pid!="0")
                        drawLineWithoutCartoon(temp.context,nodeArray[temp.pid-1],temp,markColor,width[temp.level-2],distance[temp.level-1],0,radiuses[temp.level-1]);
                    temp=nodeArray[temp.pid-1];
                }
            }
            // for(var i=0;i<pathArray.length-1;i++){
            //     message+=pathArray[pathArray.length-i-1]+"--->";
            // }
            // message+=pathArray[0];
            // changePath(declareSpan,message);

            if(node.id!=1)
                message=path[node.id-1].rule;

            createPath(canvas,node,msgSpan,message);
        }

        function out() {
            var temp = node;
            if (temp.isempty == false) {
                while (temp != null) {
                    temp.color = colors[temp.level - 1];
                    temp.drawCircle(temp);
                    if (temp.pid != "0")
                        drawLineWithoutCartoon(temp.context, nodeArray[temp.pid - 1], temp, colors[temp.level - 1], width[temp.level - 2], distance[temp.level - 1], 0, radiuses[temp.level - 1]);
                    temp = nodeArray[temp.pid - 1];
                }
            }
            // document.getElementById("pathMsg").innerHTML="";
            msgSpan.remove();
        }

        function click() {
            var temp = node;
            var temp2 = node;
            if(temp.level!=1&&temp.level!=6){
                if (temp.isShrinked == false) {
                    temp.isShrinked=true;
                    var a=totalInterval;
                    for(var i=0;i<temp.level-1;i++)
                        a-=$('#canvastree').width()*intervals[i];
                    temp.context.clearRect(temp.x - a - radiuses[5], postY[5] - radiuses[5], 2 * (a + radiuses[5]), Math.abs(postY[5] - postY[temp.level-1]) + radiuses[5] + radiuses[temp.level-1]);

                    clearNode(temp.leftchild);
                    clearNode(temp.rightchild);

                    while (temp != null) {
                        temp.color = colors[temp.level - 1];
                        temp.drawCircle(temp);
                        if (temp.pid != "0")
                            drawLineWithoutCartoon(temp.context, nodeArray[temp.pid - 1], temp, colors[temp.level - 1], width[temp.level - 2], distance[temp.level - 1], 0, radiuses[temp.level - 1]);
                        temp = nodeArray[temp.pid - 1];
                    }
                    node.label.innerHTML="均值"+node.mean+"<br>"+"方差"+node.mse;
                    node.label.style.left=node.x-node.label.offsetWidth/2+'px';
                    node.isleaf="true";
                }else{
                    appear(temp2);

                    drawNode(temp2.leftchild);
                    drawNode(temp2.rightchild);

                    node.label.innerHTML=node.name;
                    node.label.style.left=node.x-node.label.offsetWidth/2+'px';
                    node.isleaf="false";
                    temp2.isShrinked=false;
                }
            }
        }
    }
}
function drawLineWithoutCartoon(context,c1,c2,color,width,radius1,index,radius2) {
    //c1:下层节点 c2:上层节点 radius1:上层节点半径 radius2:下层节点半径
    context.beginPath();
    context.lineWidth = width;
    context.strokeStyle = color;
    context.moveTo(c1.x+radius2*Math.pow(-1,index+1), c1.y);
    context.lineTo(c2.x, c1.y);
    context.lineTo(c2.x, c2.y);
    context.stroke();
    context.closePath();
}


function clearNode(node) {
    if(node!=null){
        node.isShrinked="true";
        node.label.style.display="none";
        clearNode(node.leftchild);
        clearNode(node.rightchild);
    }
}

function drawNode(node) {
    if(node!=null){
        node.isShrinked="false";
        node.label.style.display="block";
        drawNode(node.leftchild);
        drawNode(node.rightchild);
    }
}

function appear(node){
    if(node!=null){
        node.drawCircle(node);
        if(node.leftchild!=null){
            drawLineWithoutCartoon(node.context,node,node.leftchild,colors[node.level],width[node.level-1],distance[node.level-1],0,radiuses[node.level-1]);
            drawLineWithoutCartoon(node.context,node,node.rightchild,colors[node.level],width[node.level-1],distance[node.level-1],1,radiuses[node.level-1]);
        }
        if(node.leftchild==null){
            node.label.innerHTML="均值"+node.mean+"<br>"+"方差"+node.mse;
        }else{
            node.label.innerHTML=node.name;
        }

        appear(node.leftchild);
        appear(node.rightchild);
    }
}

function createDeclare(){
    var declareSpan = document.createElement("span");
    declareSpan.style.position="absolute";
    // declareSpan.style.top=node.y+$('#analysismat').height()*0.19-(6-node.level)*1.5+'px';
    declareSpan.style.top=10+'px';
    declareSpan.style.left=1540+'px';
    declareSpan.style.fontSize=16+'px';
    declareSpan.innerHTML = "左True右False";
    document.getElementById("treediv").appendChild(declareSpan);
}
function createRule(){
    document.getElementById("treediv").removeChild(ruleSpan);
    window.ruleSpan = document.createElement("span");
    ruleSpan.style.position="absolute";
    ruleSpan.style.top='80%';
    ruleSpan.innerHTML = tree_rule;
    ruleSpan.style.left=(canvas.width-calcStringPixelsCount(tree_rule,20))/2+'px';
    ruleSpan.style.fontSize=20+'px';

    String.prototype.myReplace=function(f,e){//吧f替换成e
            var reg=new RegExp(f,"g"); //创建正则RegExp对象
            return this.replace(reg,e);
        }

        ruleSpan.innerHTML=ruleSpan.innerHTML.myReplace("\\+",'<span style="backgroundColor:#000c3c;color:red;">+</span>');
        ruleSpan.innerHTML=ruleSpan.innerHTML.myReplace('\\*','<span style="backgroundColor:#000c3c;color:red;">*</span>');
        ruleSpan.innerHTML=ruleSpan.innerHTML.myReplace('= ','<span style="backgroundColor:#000c3c;color:yellow;">' + ' = ' + '</span>');
        document.getElementById("treediv").appendChild(ruleSpan);
}

function createPath(canvas,node,span,message){
    if(node.id!=1){
        span.style.position="absolute";
        span.style.top='70%';
        // span.style.left=canvas.width/2-calcStringPixelsCount(message,22)/2+'px';
        span.style.left=canvas.width/2-span.offsetWidth/2+'px';
        span.style.fontSize=22+'px';
        span.innerHTML = message;
        String.prototype.myReplace=function(f,e){//吧f替换成e
            var reg=new RegExp(f,"g"); //创建正则RegExp对象
            return this.replace(reg,e);
        }

        span.innerHTML=span.innerHTML.myReplace(" and ",'<span style="backgroundColor:#000c3c;color:yellow;">' + " and " + '</span>');
        span.innerHTML=span.innerHTML.myReplace(" &lt;",'<span style="backgroundColor:#000c3c;color:red;"></span>');
        span.innerHTML=span.innerHTML.myReplace('= ','<span style="backgroundColor:#000c3c;color:red;">' + ' ≤ ' + '</span>');

        span.innerHTML="{ "+span.innerHTML.myReplace(" &gt;",'<span style="backgroundColor:#000c3c;color:red;">' + " &gt;" + '</span>')+" }"
            +'<span style="color:orange;">' + ' ⇒ ' + '</span>' +"均值"+node.mean+"/"+"方差"+node.mse;
        document.getElementById("treediv").appendChild(span);
    }


}

function createTreeV(title){

    var mytree=new treeMenu(zNodes);
    mytree.init(1)
    mytree.createTreeVisual(mytree)
}

